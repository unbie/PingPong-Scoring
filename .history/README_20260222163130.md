# 智能乒乓球计分系统

## 项目简介

智能乒乓球计分系统是一款基于计算机视觉和语音识别技术的创新型应用，旨在为乒乓球比赛提供自动化的计分和实时反馈功能。通过摄像头和麦克风，系统能够实时检测选手的手势和语音指令，自动更新比分并提供语音播报和视觉反馈。

## 功能特点

- **手势识别**：利用MediaPipe技术，实时检测选手的手势动作（如触摸球桌）以判断得分。
- **语音识别**：通过Google语音API，识别选手的语音指令（如"A得分"或"B得分"）进行计分。
- **实时比分显示**：通过OpenCV实现大字体的实时比分显示，便于观众和选手查看。
- **发球方提示**：系统自动提示当前发球方，并通过语音播报。
- **比赛规则自动化**：支持11分制规则，每得2分自动切换发球方。
- **防误判机制**：设置冷却时间，避免重复计分。

## 技术架构

- **前端/UI**：基于OpenCV和Pillow实现的实时图形界面。
- **后端逻辑**：使用Python和NumPy处理数据和实现比赛逻辑。
- **手势识别**：采用MediaPipe Hands进行21个关键点的检测。
- **语音识别**：集成SpeechRecognition库，使用Google语音API进行语音处理。
- **语音播报**：通过pyttsx3实现实时语音播报功能。
- **开发语言**：Python 3.7+

## 安装与运行

### 环境要求

1. **操作系统**：Windows 10 或更高版本。
2. **Python版本**：Python 3.7 或更高。
3. **硬件要求**：
   - 摄像头：支持高清拍摄。
   - 麦克风：支持清晰的语音输入。

### 安装步骤

1. 克隆项目代码：
   ```bash
   git clone <项目地址>
   cd table_tennis
   ```
2. 安装依赖：
   ```bash
   pip install -r requirements.txt
   ```
3. 运行主程序：
   ```bash
   python main_table_tennis_scorer.py
   ```

## 使用说明

### 控制方式

- **手势识别**：
  - 面向摄像头做"触摸桌面"手势以记录得分。
- **语音识别**：
  - 通过麦克风说出"A得分"或"B得分"，系统将自动为对应选手计分。
- **键盘控制**：
  - `q`: 退出程序。
  - `r`: 重置比分。
  - 
### 比赛规则

- 采用11分制，需领先2分获胜。
- 每得2分后交换发球权。
- 得分后有3秒冷却期，防止重复计分。

## 配置文件

用户可以通过修改 [config.py](./config.py) 文件自定义以下参数：

- 摄像头设置（分辨率、帧率等）。
- 手势识别灵敏度。
- 语音识别参数（能量阈值、关键词等）。
- 比赛规则（得分上限、发球规则等）。
- UI显示设置（字体大小、颜色等）。
- 调试模式开关。

## 注意事项

- 确保光线充足，摄像头视野清晰。
- 语音识别功能需要稳定的互联网连接。
- 在安静的环境中使用语音识别功能以提高准确性。
- 如果在Windows系统上出现中文乱码问题，请参考以下解决方案：
  1. 设置控制台代码页为UTF-8：
     ```cmd
     chcp 65001
     ```
  2. 在Python运行时指定编码：
     ```cmd
     python -X utf8 main_table_tennis_scorer.py
     ```
  3. 设置环境变量：
     ```cmd
     set PYTHONIOENCODING=utf-8
     python main_table_tennis_scorer.py
     ```

## 已知问题

- 光线不足时，手势识别可能不稳定。
- 语音识别对背景噪音较为敏感。
- 多人场景下的识别精度有待优化。
- Windows系统下可能出现中文显示问题。

## 开发计划

1. 增加更多的手势识别类型。
2. 提供更灵活的语音关键词配置。
3. 增加网络功能，支持远程计分。
4. 添加比赛回放和统计功能。
5. 优化语音识别的背景噪音处理。

## 贡献

欢迎对本项目提出建议或贡献代码！请通过提交Issue或Pull Request与我们联系。

## 许可证

本项目基于MIT许可证开源，详情请参阅 [LICENSE](./LICENSE)。
